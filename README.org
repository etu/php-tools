[[https://travis-ci.org/etu/php-tools][https://travis-ci.org/etu/php-tools.svg?branch=master]]

* Install with composer:
composer.json
#+NAME: composer.json
#+BEGIN_SRC json
{
    "repositories": [
        {
            "url": "https://github.com/etu/php-tools.git",
            "type": "git"
        }
    ],
    "require": {
        "etu/ET": "dev-master"
    }
}
#+END_SRC

* Example usage of Config and Db

config.ini
#+NAME: config.ini
#+BEGIN_SRC ini
[@]
db.dsn = 'sqlite::memory:'
db.username =
db.password =

[example.com]
db.username = live

[*.dev.example.com]
db.username = dev
#+END_SRC

test.php
#+NAME: test.php
#+BEGIN_SRC php
<?php
require('vendor/autoload.php');

// Second param, env, is optional. But matches titles in ini file to load config.
$config = new Etu\PhpTools\Config('config.ini', 'optional.example.com');
$db = new Etu\PhpTools\Db($config, new Etu\PhpTools\Db\PdoBackend());

$db->query('CREATE TABLE names(id INTEGER PRIMARY KEY, name VARCHAR(10));');
$db->query('INSERT INTO names(id, name) VALUES (NULL, "Alice");');
$db->query('INSERT INTO names(id, name) VALUES (NULL, "Bob");');

print_r(
    $db->query(
        'SELECT * FROM names WHERE name = :name',
        [':name' => 'Alice']
    )->fetchAll()
);
#+END_SRC
